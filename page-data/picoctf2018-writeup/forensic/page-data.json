{"componentChunkName":"component---src-components-post-template-index-js","path":"/picoctf2018-writeup/forensic/","webpackCompilationHash":"fb50f74ef8fc4b66be0d","result":{"data":{"markdownRemark":{"html":"<h2 id=\"forensic-warmup-1\"><a href=\"#forensic-warmup-1\" aria-label=\"forensic warmup 1 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Forensic Warmup 1.</h2>\n<p>Just do what the game ask you to do. Unzip it, open the picture file and key in the flag.</p>\n<hr>\n<h2 id=\"forensic-warmup-2\"><a href=\"#forensic-warmup-2\" aria-label=\"forensic warmup 2 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Forensic Warmup 2.</h2>\n<p>The file is named flag.png, but in fact it is a jpeg file. If you are on a Unix OS, just open the file normally, because on these OSes they don't infer the file type from the extension name. But if you are on Windows, rename it into flag.jpg and you can open it normally</p>\n<hr>\n<h2 id=\"recovering-from-the-snap\"><a href=\"#recovering-from-the-snap\" aria-label=\"recovering from the snap permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recovering from the snap</h2>\n<p>The problem starts with a .dd file. Running <code class=\"language-bash\"><span class=\"token function\">file</span></code> on it reveals that the file is a raw disk image. You can mount it to see what's there. On Mac OS it's really simple, just change the extension into .dmg and open it normally, and I think it will just takes a few commands on Linux.</p>\n<p>Anyway, if you take a look in the disk, nothing of interest will shows up. However, the hint says that some files have been deleted, so we may find the solution if we can restore these deleted files. There's a command made specifically to do this, it's called foremost. Installed it, then run the following command on the disk image file.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">    foremost -t jpg -i animals.dd</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>You can learn more about <code class=\"language-bash\">foremost</code> by running <code class=\"language-bash\"><span class=\"token function\">man</span> foremost</code>\nThe command will generate a folder called output right where you run it, which contains every image files in can recover from the disk. The flag resides in one of these images.</p>\n<hr>\n<h2 id=\"admin-panel\"><a href=\"#admin-panel\" aria-label=\"admin panel permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Admin Panel</h2>\n<p>Open the file in Wireshark, and analyze the packets. The flag is shown, in plaintext, in one of these.</p>\n<hr>\n<h2 id=\"hex-editor\"><a href=\"#hex-editor\" aria-label=\"hex editor permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hex Editor</h2>\n<p>Open the given file in any hex editor, and search for the phrase \"picoCTF\" to get the flag</p>\n<hr>\n<h2 id=\"truly-an-artist\"><a href=\"#truly-an-artist\" aria-label=\"truly an artist permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Truly an Artist</h2>\n<p>Use <code class=\"language-text\">pngcheck</code> or <code class=\"language-text\">exiftool</code> to analyze the image metadata. The flag is in the artist field.</p>\n<p>-- </p>\n<h2 id=\"now-you-dont\"><a href=\"#now-you-dont\" aria-label=\"now you dont permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Now you don't</h2>\n<p>The problem suggest that there might be more than one shade of red in the image, but we can't see the difference. But if you recolor it into much more different colors, then we could see the flag more clearly.</p>\n<p>The script below compare every pixel in the image to an arbitrary pixel that I pick near the corner. If it's a match, then the script turn that pixel into black. After that, the flag will show up in the image file.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">from</span> PIL <span class=\"token keyword\">import</span> Image\n\nim <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span><span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"nowYouDont.png\"</span><span class=\"token punctuation\">)</span>   \nout <span class=\"token operator\">=</span> Image<span class=\"token punctuation\">.</span>new<span class=\"token punctuation\">(</span><span class=\"token string\">'I'</span><span class=\"token punctuation\">,</span> im<span class=\"token punctuation\">.</span>size<span class=\"token punctuation\">,</span> <span class=\"token number\">0xffffff</span><span class=\"token punctuation\">)</span>\n\nwidth<span class=\"token punctuation\">,</span> height <span class=\"token operator\">=</span> im<span class=\"token punctuation\">.</span>size\n<span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>width<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> y <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>height<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        r<span class=\"token punctuation\">,</span>g<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">,</span>a <span class=\"token operator\">=</span> im<span class=\"token punctuation\">.</span>getpixel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> r <span class=\"token operator\">==</span> <span class=\"token number\">145</span> <span class=\"token keyword\">and</span> g <span class=\"token operator\">==</span> <span class=\"token number\">32</span> <span class=\"token keyword\">and</span> b <span class=\"token operator\">==</span> <span class=\"token number\">32</span><span class=\"token punctuation\">:</span>\n            im<span class=\"token punctuation\">.</span>putpixel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\nim<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"nowYouDont.png\"</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","frontmatter":{"date":"2019-09-21T10:52:00.000Z","title":"PicoCTF 2018 Writeup Forensic.","keyword":["ctf","hacking","forensic"],"description":"Grab your pipe and your coat cuz we are going to do some investigation."},"fields":{"slug":"/picoctf2018-writeup/forensic/"},"tableOfContents":"<ul>\n<li><a href=\"/picoctf2018-writeup/forensic/#forensic-warmup-1\">Forensic Warmup 1.</a></li>\n<li><a href=\"/picoctf2018-writeup/forensic/#forensic-warmup-2\">Forensic Warmup 2.</a></li>\n<li><a href=\"/picoctf2018-writeup/forensic/#recovering-from-the-snap\">Recovering from the snap</a></li>\n<li><a href=\"/picoctf2018-writeup/forensic/#admin-panel\">Admin Panel</a></li>\n<li><a href=\"/picoctf2018-writeup/forensic/#hex-editor\">Hex Editor</a></li>\n<li><a href=\"/picoctf2018-writeup/forensic/#truly-an-artist\">Truly an Artist</a></li>\n<li><a href=\"/picoctf2018-writeup/forensic/#now-you-dont\">Now you don't</a></li>\n</ul>"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"older":{"frontmatter":{"title":"PicoCTF 2018 Writeup Web Exploitation.","date":"2019-09-17T23:12:00.000Z","description":"No Facebook hacking tutorial though.","keyword":["ctf","hacking","web"]},"fields":{"slug":"/picoctf2018-writeup/web/","readingTime":{"text":"5 min read"}}},"newer":{"frontmatter":{"title":"PicoCTF 2018 Writeup Reverse Engineering.","date":"2019-09-21T11:50:00.000Z","description":"Break it down.","keyword":["ctf","hacking"]},"fields":{"slug":"/picoctf2018-writeup/reversing/","readingTime":{"text":"1 min read"}}},"series":"picoctf2018-writeup"}}}