{"componentChunkName":"component---src-components-post-template-index-js","path":"/picoctf2018-writeup/general/","webpackCompilationHash":"fb50f74ef8fc4b66be0d","result":{"data":{"markdownRemark":{"html":"<p>So basically I think it's time to try my hand on some hacking, to see if I can do it.\n<a href=\"https://2018game.picoctf.com\">PicoCTF</a> is a good site for some easy Capture The Flag (CTF) exercise according to my friends, so I guess I would start there.</p>\n<p>Okay, let's take a look at the home page. You should be able to register for an account without any problem. After signing in you can go to the <a href=\"https://2018game.picoctf.com/game\">Game tab</a>, where the game will be loaded. Then they will show some introductions so you can get comfortable with the game.</p>\n<p>You should do this on some Unix-based OS, like Linux or Mac OS, because they have a lot of useful tools pre-installed.</p>\n<p>Including too much image of the problems is going to bloat my repository, so I guess I will show image on hard problems only.</p>\n<hr>\n<h2 id=\"general-warmup-1-2-3\"><a href=\"#general-warmup-1-2-3\" aria-label=\"general warmup 1 2 3 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>General Warmup 1-2-3</h2>\n<p>To solve these, just use some kind of converter like <a href=\"https://codebeautify.org/hex-string-converter\">this</a></p>\n<hr>\n<h2 id=\"resources\"><a href=\"#resources\" aria-label=\"resources permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Resources</h2>\n<p>Go to the link and find the flag</p>\n<hr>\n<h2 id=\"grep-1\"><a href=\"#grep-1\" aria-label=\"grep 1 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Grep 1</h2>\n<p>Download the file. Navigate to the directory where you downloaded it on Terminal, then execute <code class=\"language-bash\"><span class=\"token function\">grep</span> <span class=\"token string\">\"picoCTF\"</span> <span class=\"token function\">file</span></code>. Voila, you can see the flag.</p>\n<hr>\n<h2 id=\"net-cat\"><a href=\"#net-cat\" aria-label=\"net cat permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Net Cat</h2>\n<p>Okay, for this one you can run <code class=\"language-bash\"><span class=\"token function\">nc</span> 2018shell.picoctf.com <span class=\"token number\">49387</span></code>. The flag will be printed to your console.</p>\n<hr>\n<h2 id=\"strings\"><a href=\"#strings\" aria-label=\"strings permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Strings</h2>\n<p>First download the file. Running a <code class=\"language-bash\"><span class=\"token function\">cat</span></code> on it shows that it is a binary file. However, running it as an executable yields nothing.</p>\n<p>However, you can use the <code class=\"language-bash\">string</code> command to find plaintext, readable strings inside the file, excluding every binary characters. By running <code class=\"language-bash\">string <span class=\"token function\">file</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\"picoCTF\"</span></code>, you can sift through the output of <code class=\"language-bash\">string <span class=\"token function\">file</span></code> for any string contains \"picoCTF\". You can see the flag by now</p>\n<hr>\n<h2 id=\"pipe\"><a href=\"#pipe\" aria-label=\"pipe permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Pipe</h2>\n<p>In the previous problem, I use a shell syntax called output piping. To put it simply, the output of the previous command will be <strong>\"piped\"</strong> to the input of the next command.</p>\n<p>In this problem, running <code class=\"language-bash\"><span class=\"token function\">nc</span> 2018shell.picoctf.com <span class=\"token number\">37542</span></code> will yield a fast moving bunch of text. Instead of searching through this mess for the flag, we will pipe it to <code class=\"language-bash\"><span class=\"token function\">grep</span></code>, just like the previous problem.</p>\n<p>Running <code class=\"language-bash\"><span class=\"token function\">nc</span> 2018shell.picoctf.com <span class=\"token number\">37542</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">\"picoCTF\"</span></code> will show you the flag.</p>\n<hr>\n<h2 id=\"grep-2\"><a href=\"#grep-2\" aria-label=\"grep 2 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Grep 2.</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/47f86fb6faf52eb3f4c55639d3c721b9/374ce/grep2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 81.76197836166925%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACiElEQVQ4y5VUuW4TURSdCgGOl9m8jMeze+yE2Ikdx8IJGAI4KAI6JKSAIBINEAlBQRIkBBUFiyiAKiyiATp+8XDem7ETEwlBcXTufe/OuduzlUarDTtsEDHsqJHaDdRoV4I6rLk2/M4ywm6f9gIsnrvxLJx6kyDTrvoR+sM13HuyC6XseCgHMcL5RfizLUStDiLa4XwHAcUW+ito906jOziLiL7pRii6IUwv4aJXh1Z1UfLriBd7FGRlcbuL1QsjrKyN0DtzDt2VIQZrl9BaHiBeWJJoMFh8UGdCmZzioUy8CJuVFiwHWqUGJcvqDNuDXgtgOAHZh+6EklXbR45BhaqHPDlPFh+q9lHWUyj5oAGdJWsU0HigUViwLsQpaLiJ+Jh1weI+ZcNJfcZOBMcVTsP/D/aloJYINqFZLkt3obIl1XJllTKjzJ6wNvG9oyzjvUQwyy3VoqYcvNwwFyS2d1j0r2JOMBGVgjm2bLLk0vgZMNAYt3FkDP/astimyMgHrXPrBb4pVfjMrh3a+uERTHHaslxKhpUVwiaOdQcoDkcon1/H8d4qMnMdmBQ0OBKxyYSDCZtTvugqQI7FKSdZkVqykFFNzGgmMsSMXqRdTPnAz0z5jFWNCfLFCnL1U1BOsJW54To2Hj3HaHsPowd7Ke8mPMb9nYNzYn37KTYev8Dlh89wZecl5i9eRb5sQynYLpau3cDWx5/YfP0JN99+Jb5g883niS/tFNJ/tY9b777hzocfuP3+O+7u/0L/+hYKrFJxohjZooWsUUbWHKOSgAF53k3A0STnloybMUoJOIJ8qcqluFBqYV0+mTI3+yfEP4gmNsl7+VPzktgKX4OMCVL2Y5SFhhfiN/Rt0N+EGwRjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Grep 2\"\n        title=\"Grep 2\"\n        src=\"/static/47f86fb6faf52eb3f4c55639d3c721b9/b9e4f/grep2.png\"\n        srcset=\"/static/47f86fb6faf52eb3f4c55639d3c721b9/cf440/grep2.png 148w,\n/static/47f86fb6faf52eb3f4c55639d3c721b9/d2d38/grep2.png 295w,\n/static/47f86fb6faf52eb3f4c55639d3c721b9/b9e4f/grep2.png 590w,\n/static/47f86fb6faf52eb3f4c55639d3c721b9/374ce/grep2.png 647w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>This problem will requires you to use the web-shell. Go to the <a href=\"https://2018game.picoctf.com/shell\">Shell tab</a>, you will see a command prompt.</p>\n<p><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span></code> to the directory given by the problems, then <code class=\"language-bash\"><span class=\"token function\">ls</span></code>, you'll be greeted by a bunch of directory. Traversing all of them by hand and check if there is any file contains the flag is not feasible.</p>\n<p>However, <code class=\"language-bash\"><span class=\"token function\">grep</span></code> has an option <code class=\"language-text\">-R</code> which search the strings given recursively, and this is what we'll use. Executing <code class=\"language-bash\"><span class=\"token function\">grep</span> -R <span class=\"token string\">\"picoCTF\"</span></code> will give you the flag.</p>\n<hr>\n<h2 id=\"aca-shell-a\"><a href=\"#aca-shell-a\" aria-label=\"aca shell a permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ACA-Shell-A</h2>\n<p>This one is an interesting one, as you will be put in a interactive and narrated shell. It's just like a game on terminal.</p>\n<p>First, execute the command in the problem's instruction.</p>\n<p>The narrator says that you can ask for help by running <code class=\"language-bash\"><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'Help Me!'</span></code>. Sweet. Let's try it since we don't really know what to do.</p>\n<p>The narrator reply with <code class=\"language-text\">Have you looked for any directory</code>. Let's try a <code class=\"language-bash\"><span class=\"token function\">ls</span></code> first</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">~/$ <span class=\"token function\">ls</span>\nblackmail\nexecutables\npasswords\nphotos\nsecret</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Sweet. You can poke around in these directories, but what you need is in <code class=\"language-text\">secret</code>. Let's <code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span></code> into it.</p>\n<p>A <code class=\"language-bash\"><span class=\"token function\">ls</span></code> reveals a bunch of files. The shell then asks you to sabotage the intel files. In order to delete them in a single command, run <code class=\"language-bash\"> <span class=\"token function\">rm</span> intel_*</code></p>\n<p>The narrator will then tell you to run <code class=\"language-bash\"><span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'Drop it in!'</span></code>. Run it, and there will be a new file in the <code class=\"language-text\">~/executables</code> directory. <code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span></code> to it, then <code class=\"language-bash\"><span class=\"token function\">ls</span></code> to see what's the file name.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">~/executables$ <span class=\"token function\">ls</span>\ndontLookHere</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>The <code class=\"language-text\">dontLookHere</code> file is an executable, means that you can run it by typing <code class=\"language-text\">./dontLookHere</code>. The screen will print out some hex code, and then the narrator will ask you to find the username. Typing <code class=\"language-text\">whoami</code> will give you the username.</p>\n<p>The narrator will finally say that you have to copy a file in <code class=\"language-text\">tmp</code> called <code class=\"language-text\">TopSecret</code> to the <code class=\"language-text\">passwords</code> directory. In Linux, the <code class=\"language-text\">tmp</code> directory resides in root, aka <code class=\"language-text\">/</code>. So you should issue the following command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">~/executables$ <span class=\"token function\">cp</span> /tmp/TopSecret <span class=\"token punctuation\">..</span>/passwords\n<span class=\"token punctuation\">..</span>/password: directory not found or permitted</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>What?\nLet's ask the narrator to see if he has any clue.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">~/executables$ <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Help Me!\"</span>\nYou are going to have to <span class=\"token keyword\">do</span> it from the home folder because of the <span class=\"token string\">\"..\"</span> restrictions<span class=\"token operator\">!</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Oh okay, let's try again. <code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> <span class=\"token punctuation\">..</span></code> to get back to the home folder, then <code class=\"language-bash\"><span class=\"token function\">cp</span> /tmp/TopSecret passwords</code> to copy the file. It does work this time.</p>\n<p>The narrator will then says that the server will shut down in 10 seconds, and you must read the file quickly. Just run <code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> passwords</code> then <code class=\"language-bash\"><span class=\"token function\">cat</span> TopSecret</code>. You will see the flag for this problem.</p>\n<hr>\n<h2 id=\"environ\"><a href=\"#environ\" aria-label=\"environ permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Environ</h2>\n<p>This is going to be easy. Open the web-shell, then execute <code class=\"language-bash\"><span class=\"token function\">env</span></code>\nThe command will show you all the environment variables on the shell. In order to find the flag easily, pipe it to <code class=\"language-bash\"><span class=\"token function\">grep</span></code></p>\n<hr>\n<h2 id=\"ssh-keyz\"><a href=\"#ssh-keyz\" aria-label=\"ssh keyz permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSH-Keyz.</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e0926d3c91313c6bacfa84fd8722aa54/82704/ssh-key.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.16463414634147%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACu0lEQVQ4y31UXW/SYBTuxbIwKWOFQgvjox98D0oLgwGDMSTbvDHxD8zMOGNMjNmMMTEx/gU1JrvwTo2J3vgXH89531KIF148ec4573mfno+2ilGyYFgVuAddWI027JYHq9mB2/ZR6/TgDyfoj6Y4nJygNzqmPF/kVumM2Wl1oeVLcNoBvNEESt6tCpHp8hyD2QKj0yUOp6eYLM5wNL8PfzxFn/xgPCN7huHJQsT7x3PKm4s7ncEYiWyeCnOhxO0qCm4djWAgqmr4h6jQ02vdPj3VR6bswnBqyFIXptuASfmGLf0c3ePu2Nf3LSQoT0k4daT3y9AKFjQKMqeIUwVb+KmiQ7ZkjfKEv7/p24LTLEgPiwRZIF1yJIrO2v4fimvoK0GVBA1uixxRoahSPjXi4j9+yKnIt5CmxSSodeVeuQKHtsoD55nZtDle0ordTiA335I+b9PZOLfYJpg0S9Wq8lJqYil1r4c8VctDz9FwGWbIwrbXMZPyzei8LpaTpbaFIM+Qh56gwG7JRZLa36Wq93joJY45SFKiiBPvUftyEVa0EB7BRssuNBLd9ocwZ0sUFheI9cZQGx60ShNb3gD65BQGnbGtNrvIkJBO4joVINkR9g5pKTvUu5YrIp42oGZMqDohkyM2JNgWoDi9vFE8lUGcoekCWq6EGAvGSjZqR3OcvXiL+89eE24lX99I+3qFmw37Fsvnb3Dx6j3OXr7Dg5sPqA5niFHlSpK+Ze/8EZ7c/cblp++4/PxDssC30A/545off/mJK7pzdfcLT7/+QXv5EMliGUqxUsMutRLfS0flxzXZjroB0V4qG8azMo/vCKSERoH+C0rOdsWnJAe7gdUXwDZtXSyAOB35zG60ENYw+efgeF3Ugz6qPv0QQrDNMcsPsFVrYbt+gO3GAdlN2OFZNQjzg3W+3fHwFzOB16NRwbF5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Ssh Key\"\n        title=\"Ssh Key\"\n        src=\"/static/e0926d3c91313c6bacfa84fd8722aa54/b9e4f/ssh-key.png\"\n        srcset=\"/static/e0926d3c91313c6bacfa84fd8722aa54/cf440/ssh-key.png 148w,\n/static/e0926d3c91313c6bacfa84fd8722aa54/d2d38/ssh-key.png 295w,\n/static/e0926d3c91313c6bacfa84fd8722aa54/b9e4f/ssh-key.png 590w,\n/static/e0926d3c91313c6bacfa84fd8722aa54/82704/ssh-key.png 656w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>This is a very compicated problem and requires some knowledges in SSH and how it handles authentication keys. You can possibly skips the work and grab the flags by executing <code class=\"language-bash\"><span class=\"token function\">ssh</span> 2018shell.picoctf.com@your_picoctf_username</code> and enter the password. However, I'll describe about the authentication key approach, because afterward you can SSH to the server without having to enter the password.</p>\n<p>SSH Key Authentication work like this:</p>\n<ul>\n<li>In order to authenticate, you must own a key pair, one is public and the other private. The private key can be used to decode any data that is encoded using the public key, but the other way around doesn't work.</li>\n<li>When a client (your computer) send a request to connect to the host (the game's shell server) with a key, first the host will search for a public key that belongs to the client.</li>\n<li>If a public key is found, the host will use it to encrypt a code, and send it to the client. The client will use the private key to decrypt the code, and send it back to the host. If the host see that the code sent match with the code received, it will establish a connection.</li>\n</ul>\n<p>First you have to generate a key pair. It's really simple. Execute <code class=\"language-bash\">ssh-keygen -C <span class=\"token string\">\"vietanisme@gmail.com\"</span> -t rsa</code> on your machine. If you are asked whether to overwrite a file, you can specified a directory to put the key.</p>\n<p>After generating the key, you can just copy the public key to the host. First open the public key file and copy the content of it.\nOpen the webshell and run:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">    <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"the content of the public key\"</span> <span class=\"token operator\">></span> ~/.ssh/authorized_keys</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Close the webshell. Open a terminal on your computer and run <code class=\"language-bash\"><span class=\"token function\">ssh</span> 2018shell.picoctf.com@your_picoctf_username</code>. If all the steps above is done correctly, you should be able to login to the server without having to input password. The flag will be given on login.</p>\n<hr>\n<h2 id=\"what-base-is-this\"><a href=\"#what-base-is-this\" aria-label=\"what base is this permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What base is this?</h2>\n<p>This is basically a more randomized and timed version of the first 3 problems. After <code class=\"language-bash\"><span class=\"token function\">nc</span></code> to the adresss provided by the description, you'll be presented with three quizzes, which require you to convert a string, either in hexadecimal, binary or octal into its ASCII presentation. Just use a converter like <a href=\"https://codebeautify.org/hex-string-converter\">this one</a> to convert it. Remember to be quick, because they only allow 30 seconds for each quiz.</p>\n<hr>\n<h2 id=\"you-cant-see-me\"><a href=\"#you-cant-see-me\" aria-label=\"you cant see me permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>You can't see me</h2>\n<p>Login to the shell and goto the directory specified. Doing a <code class=\"language-bash\"><span class=\"token function\">ls</span></code> shows nothing.</p>\n<p>May be the file is hidden? In order to list hidden file, run <code class=\"language-bash\"><span class=\"token function\">ls</span> -a</code>.</p>\n<p>The output is as follow</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">ls</span> -a\n<span class=\"token builtin class-name\">.</span> <span class=\"token builtin class-name\">.</span> <span class=\"token punctuation\">..</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>That's really confusing isn't it. However, if you are familiar with Linux shells, you'll see that one of the two <code class=\"language-text\">.</code> refers to that directory itself, while the <code class=\"language-text\">..</code> refers to its parent directory. If you run <code class=\"language-bash\"><span class=\"token function\">ls</span> -A</code>, these two symbols will be ignored. So this means that the folder is actually containing a file with the name <code class=\"language-text\">.</code>.</p>\n<p>However, you can not execute any command that refers directly to the name <code class=\"language-text\">.</code>, because the shell will mistake it for the current directory itself. So in order to find the flag, you should use some command that target the whole directory instead. <code class=\"language-bash\"><span class=\"token function\">grep</span></code> is a good bet.</p>\n<p>To <code class=\"language-bash\"><span class=\"token function\">grep</span></code> at a directory, you must include the <code class=\"language-text\">-R</code> flag (recursive). The complete command is <code class=\"language-bash\"><span class=\"token function\">grep</span> <span class=\"token string\">\"picoCTF\"</span> -R <span class=\"token builtin class-name\">.</span></code> (the <code class=\"language-text\">.</code> here refers to the folder, not the file). Run that, and the flag will magically appear before you</p>\n<hr>\n<h2 id=\"absolutely-relative\"><a href=\"#absolutely-relative\" aria-label=\"absolutely relative permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Absolutely relative.</h2>\n<p>The problem is starting to get complicating. This problem requires you to understand C code.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1755ec83ac845745bf1ed76712e23fe4/a5cd6/ab-rel.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.48847926267281%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAADA0lEQVQ4y4VUSW/TQBT2gQqliZM4cRI3m+1x4rhZnAWaFihbWqpWnBASLQUBaktTlgM74sJ/4IJEEQckLkhsF37fx/ecthyKxOHTN++9mTdvm9GsqoNcVcFpNFGtByh5PtygCZtyo9OF4tr1Z+G3QjTaIbxmBzOOh6Kqo6RqEefKDqpBG8HpITTL9dBfXMK9p2+x+fA1Nh68xI3xC6w/eIW12w+xvL6DK8TKzV2sbNzHKnltc4zVzT3qxrh65zGawwtImBZMW0FLODU4QYjwzGV0z47QXrgIpzMHu30aqjtPDOH1FqDCIVSPcjgHl3qXshvZ52HVmsgWq0jSl5byGjAoJGYqiBeK0MlJyinBTBnJkk1bGbocOLRZpYldmDo5b5Zd6LYHLe360N0GpvoLKI9WYV28gtjcOcQbHaR4s+jz55dRuLCMk4MzmGY2uYpCturBZO0FWcpmyaFDRpikM8upo6AayHBThsY0b0sxMoNsVFxkuVFsBg8bbECkpz0jXLQjXZayLiknuLne7qG3sIh6OIDfPQWfHPRZO+rdFjst4FrYng0jvWoJZN1HrdNHgX6ilHXHR6UWRM6OQKeyqUh9jrcWWJaCW484z2wsdSj/xVENUypAhmGnJUXWwShNUkgXJylFYBky1P2T5YyURVKWGsZdGUwXJiMxpdCMwORNOeFD+Rir40zbtEQ4zfCNQgnxTA6JbB4J4cwBZ//DB/vihgmD4xPjC9JiDDc4t4QlvoxL209wefcZRnsvMeJrGY3/wbvPj3jpgJcfvUGdryVWtlnDchXDa7cw/vQLd999wdb7r9j58A3b+z+w/VHw8y/vH+et/e8Yf/6N3tp1Dn8FmlPzEZNicmDN+UXog3lofhvTTEGP0iscgOmZE9bJOnUTzke6tFVm9+mn5CgkpeV8FTnOWDbocD3LzqnoRURgwY+4qiadjwbbmbB0mgHkbReaG3bhdWU4ZXhlUAmua9TNNNs4wS9tit/XlN/ECc5lsdVBrTfgRzGIzgmUnKdcabXxB2NW4NBlo3DeAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ab rel\"\n        title=\"ab rel\"\n        src=\"/static/1755ec83ac845745bf1ed76712e23fe4/b9e4f/ab-rel.png\"\n        srcset=\"/static/1755ec83ac845745bf1ed76712e23fe4/cf440/ab-rel.png 148w,\n/static/1755ec83ac845745bf1ed76712e23fe4/d2d38/ab-rel.png 295w,\n/static/1755ec83ac845745bf1ed76712e23fe4/b9e4f/ab-rel.png 590w,\n/static/1755ec83ac845745bf1ed76712e23fe4/a5cd6/ab-rel.png 651w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Open the shell at the directory and inspect it. You can find 3 files inside: <code class=\"language-text\">absolute-relative</code> is an executable, <code class=\"language-text\">absolute-relative.c</code> is the source code of the former, and <code class=\"language-text\">flag.txt</code> is the file that contain the flag.</p>\n<p>You can not read the <code class=\"language-text\">flag.txt</code>, because you don't have the read permission. Only the executable have the permission to read that file, so it is the only way to get the flag.</p>\n<p>Let's check the content of the script. Run <code class=\"language-bash\"><span class=\"token function\">cat</span> absolute-relative.c</code> will yield</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-c line-numbers\"><code class=\"language-c\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> yes_len 3</span>\n<span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>yes <span class=\"token operator\">=</span> <span class=\"token string\">\"yes\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">char</span> flag<span class=\"token punctuation\">[</span><span class=\"token number\">99</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">char</span> permission<span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">;</span>\n    FILE <span class=\"token operator\">*</span> file<span class=\"token punctuation\">;</span>\n\n    file <span class=\"token operator\">=</span> <span class=\"token function\">fopen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/.../flag.txt\"</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    \t<span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token function\">fscanf</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">,</span> <span class=\"token string\">\"%s\"</span><span class=\"token punctuation\">,</span> flag<span class=\"token punctuation\">)</span><span class=\"token operator\">!=</span><span class=\"token constant\">EOF</span><span class=\"token punctuation\">)</span>\n    \t<span class=\"token function\">fclose</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    file <span class=\"token operator\">=</span> <span class=\"token function\">fopen</span><span class=\"token punctuation\">(</span> <span class=\"token string\">\"./permission.txt\"</span> <span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    \t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token function\">fscanf</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">,</span> <span class=\"token string\">\"%s\"</span><span class=\"token punctuation\">,</span> permission<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        permission<span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">'\\0'</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">fclose</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">strncmp</span><span class=\"token punctuation\">(</span>permission<span class=\"token punctuation\">,</span> yes<span class=\"token punctuation\">,</span> yes_len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You have the write permissions.\\n%s\\n\"</span><span class=\"token punctuation\">,</span> flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You do not have sufficient permissions to view the flag.\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>This look like a lot but let's tackle it line by line. Two C function that you should understand is <code class=\"language-c\">fscanf</code> and <code class=\"language-c\">strncmp</code>, for which you could look up the documentation <a href=\"http://www.cplusplus.com/reference/cstdio/fscanf/\">here</a> and <a href=\"http://www.cplusplus.com/reference/cstring/strncmp/\">here</a>\nFrom line 14 to line 18, the code read the final sentence of that <code class=\"language-text\">flag.txt</code> file into the <code class=\"language-text\">flag</code> variable. The while loop ensure that the <code class=\"language-text\">flag</code> variable will have the content of the final sentence in the file.</p>\n<p>Next, from line 20 to 27 it read every string, seperated by a white-space character in a file called <code class=\"language-text\">./permission.txt</code>. It reads 5 string, then store the value in a char array called <code class=\"language-text\">permission</code>. Each reading iteration overwrite the variable, so the 5th string will be its final value.</p>\n<p>The part of code from line 29 to 33 compare the <code class=\"language-text\">permission</code> string to the string <code class=\"language-text\">yes</code>, up to 3 characters.</p>\n<p>Therefore, you must create a <code class=\"language-text\">permission.txt</code> file that contains 5 strings. The first 4 can be anything as long as it is shorter than 9 characters, so that it doesn't overflow the permission variable. The final one should be <code class=\"language-text\">yes</code>. The file must be put in your home folder, since the <code class=\"language-text\">/problem/...</code> is write protected.</p>\n<p>After writing such a file, you should execute <code class=\"language-text\">/problems/absolutely-relative_3_c1a43555f1585c98aab8d5d2c7f0f9cc/absolutely-relative</code>. Because you invoke the executable from your home folder, the <code class=\"language-text\">./permission.txt</code> will refers to that <code class=\"language-text\">permission.txt</code> you created above. The flag should be displayed by now.</p>\n<hr>\n<h2 id=\"in-out-error\"><a href=\"#in-out-error\" aria-label=\"in out error permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>In-Out-Error</h2>\n<p>This problem requires some knowledge in redirection. Let's go to the directory in the problem description first.</p>\n<p>This folder have two files <code class=\"language-text\">flag.txt</code> and <code class=\"language-text\">in-out-err</code>, the latter being an executable. Let's run it first.</p>\n<p>After writing \"Please may I have the flag?\", the file push out a stream of seemingly random characters. This is due to the fact that the error stream and output stream are printing simultaneously, and if ran on a interactive bash shell these two stream are merged into one. To retrieve the flag, you must split these two stream.</p>\n<p>In Linux, there's a special directory call <code class=\"language-text\">/dev/null</code>. Redirecting any stream there will discard the output.\nSince we don't know which of the two stream output and error contain the flag, one solution would be to redirect each of them to <code class=\"language-text\">/dev/null</code> and keep the other one intact.</p>\n<p>To redirect a stream, use the <code class=\"language-text\">&gt;</code> and <code class=\"language-text\">&lt;</code> operator. If you want to redirect stdout, use <code class=\"language-text\">&gt;</code>. If you want to redirect stderr, use <code class=\"language-text\">2&gt;</code></p>\n<p>Let's run these two commands, see what comes out. When redirecting stdout, remember that the prompt to input \"Please may I have the flag?\" is redirected too. Worry not, just input it and you'll be fine.</p>\n<p>Running <code class=\"language-text\">./in-out-error &gt; /dev/null</code> yields the flag.</p>\n<hr>\n<h2 id=\"store\"><a href=\"#store\" aria-label=\"store permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Store</h2>\n<p>Let's begin by doing <code class=\"language-text\">netcat</code> into the server:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">nc</span> 2018shell.picoctf.com <span class=\"token number\">53220</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>The output appears to be a shopping app. You initially have 1100 dollars. You can either buy imitation flags for 1000 dollars each, or you can buy the real flag for 100000 dollars.</p>\n<p>Let's then look into the source code. Checkout line numbers 37-38</p>\n<p>The total cost is calculated by this expression: <code class=\"language-cpp\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> <span class=\"token number\">1000</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span><span class=\"token punctuation\">)</span> number_flags</code>. The result will be evaluated with type int. As a result, when <code class=\"language-text\">number_flags</code> get a bit to high, the expression will overflow to some arbitrary negative number. If the cost is negative, instead of being charged, the shop will give you money for purchasing a lot of flag instead.</p>\n<p>Now, let's get back to the netcat shell. I choose to buy 3000000 imitation flag.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Imitation Flags cost 1000 each, how many would you like?\n3000000\n\nYour total cost is: -1294967296\n\nYour new balance: 1294968396</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now that you are rich, you can purchase the real flag.</p>\n<h2 id=\"script-me\"><a href=\"#script-me\" aria-label=\"script me permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Script me</h2>\n<p>The problem is about adding bracket strings together with the given rule.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Rules:\n() + () = ()()                                      =&gt; [combine]\n((())) + () = ((())())                              =&gt; [absorb-right]\n() + ((())) = (()(()))                              =&gt; [absorb-left]\n(())(()) + () = (())(()())                          =&gt; [combined-absorb-right]\n() + (())(()) = (()())(())                          =&gt; [combined-absorb-left]\n(())(()) + ((())) = ((())(())(()))                  =&gt; [absorb-combined-right]\n((())) + (())(()) = ((())(())(()))                  =&gt; [absorb-combined-left]\n() + (()) + ((())) = (()()) + ((())) = ((()())(())) =&gt; [left-associative]</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>If you look closely, the rules actually boil down to these:</p>\n<ul>\n<li>If the two strings have the same nested level, simple concatenate them to get the result.</li>\n<li>If the first string have the higher nested level, the result is the first string with the second string inserted right before its final bracket.</li>\n<li>If the second string have the higher nested level, the result is the second string with the first string inserted right after its first bracket.</li>\n<li>Also, if there are multiple operations, the result is calculated accumulatingly from left to right (left-associative)</li>\n</ul>\n<p>You can write a simple Python script to calculate this. The following script of mine also automatically send the answer.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-python line-numbers\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">import</span> socket\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">level</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    res <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    l <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> s<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span> i <span class=\"token operator\">==</span> <span class=\"token string\">'('</span><span class=\"token punctuation\">:</span>\n            l <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            l <span class=\"token operator\">-=</span> <span class=\"token number\">1</span>\n        res <span class=\"token operator\">=</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> l<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> res\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">,</span> str2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    str1 <span class=\"token operator\">=</span> str1<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    str2 <span class=\"token operator\">=</span> str2<span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    l1 <span class=\"token operator\">=</span> level<span class=\"token punctuation\">(</span>str1<span class=\"token punctuation\">)</span>\n    l2 <span class=\"token operator\">=</span> level<span class=\"token punctuation\">(</span>str2<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l1 <span class=\"token operator\">==</span> l2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> str1 <span class=\"token operator\">+</span> str2\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l1 <span class=\"token operator\">&lt;</span> l2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> str2<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> str1 <span class=\"token operator\">+</span> str2<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l1 <span class=\"token operator\">></span> l2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> str1<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> str2 <span class=\"token operator\">+</span> str1<span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">eval_expression</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    n <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"+\"</span><span class=\"token punctuation\">)</span>\n    res <span class=\"token operator\">=</span> n<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        res <span class=\"token operator\">=</span> add<span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> n<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> res\n\n\ns <span class=\"token operator\">=</span> socket<span class=\"token punctuation\">.</span>socket<span class=\"token punctuation\">(</span>socket<span class=\"token punctuation\">.</span>AF_INET<span class=\"token punctuation\">,</span> socket<span class=\"token punctuation\">.</span>SOCK_STREAM<span class=\"token punctuation\">)</span>\ns<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2018shell.picoctf.com\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1542</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token builtin\">buffer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n    data <span class=\"token operator\">=</span> s<span class=\"token punctuation\">.</span>recv<span class=\"token punctuation\">(</span><span class=\"token number\">4096</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> data<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">break</span>\n    data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n    <span class=\"token builtin\">buffer</span><span class=\"token punctuation\">.</span>extend<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'> '</span> <span class=\"token keyword\">in</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># print(buffer)</span>\n        i <span class=\"token operator\">=</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">buffer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span>\n        expression <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">not</span> <span class=\"token string\">\"(\"</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">buffer</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            i <span class=\"token operator\">-=</span> <span class=\"token number\">1</span>\n        <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"(\"</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">buffer</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token keyword\">or</span> <span class=\"token string\">\")\"</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">buffer</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            expression <span class=\"token operator\">=</span> <span class=\"token builtin\">buffer</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> expression\n            i <span class=\"token operator\">-=</span> <span class=\"token number\">1</span>\n        expression <span class=\"token operator\">=</span> expression<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">\"=\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>strip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        res <span class=\"token operator\">=</span> eval_expression<span class=\"token punctuation\">(</span>expression<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\\n'</span>\n        <span class=\"token builtin\">buffer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        s<span class=\"token punctuation\">.</span>sendall<span class=\"token punctuation\">(</span><span class=\"token builtin\">bytes</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">,</span> <span class=\"token string\">\"utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ns<span class=\"token punctuation\">.</span>close<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<hr>\n<h2 id=\"roulette\"><a href=\"#roulette\" aria-label=\"roulette permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Roulette</h2>\n<p>The challenge is presented as a roulette game. You get a starter amount of money, you can bet some money in a number from 1 to 36, and if you win, you get back twice that bet. If you have earned 1 billion dollars you can get the flag.</p>\n<p>Let's analyse the included code</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-c line-numbers\"><code class=\"language-c\"><span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;limits.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdint.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdlib.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;time.h></span></span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;unistd.h></span></span>\n\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> MAX_NUM_LEN 12</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> HOTSTREAK 3</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> MAX_WINS 16</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> ONE_BILLION 1000000000</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> ROULETTE_SIZE 36</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> ROULETTE_SPINS 128</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> ROULETTE_SLOWS 16</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> NUM_WIN_MSGS 10</span>\n<span class=\"token macro property\">#<span class=\"token directive keyword\">define</span> NUM_LOSE_MSGS 5</span>\n\n<span class=\"token keyword\">long</span> cash <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">long</span> wins <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">is_digit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">char</span> c<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token string\">'0'</span> <span class=\"token operator\">&lt;=</span> c <span class=\"token operator\">&amp;&amp;</span> c <span class=\"token operator\">&lt;=</span> <span class=\"token string\">'9'</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">long</span> <span class=\"token function\">get_long</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"> \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    uint64_t l <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">char</span> c <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">is_digit</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        c <span class=\"token operator\">=</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token function\">is_digit</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">>=</span> LONG_MAX<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            l <span class=\"token operator\">=</span> LONG_MAX<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        l <span class=\"token operator\">*=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span>\n        l <span class=\"token operator\">+=</span> c <span class=\"token operator\">-</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">;</span>\n        c <span class=\"token operator\">=</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>c <span class=\"token operator\">!=</span> <span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span>\n        c <span class=\"token operator\">=</span> <span class=\"token function\">getchar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> l<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">long</span> <span class=\"token function\">get_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">long</span> seed<span class=\"token punctuation\">;</span>\n    FILE <span class=\"token operator\">*</span>f <span class=\"token operator\">=</span> <span class=\"token function\">fopen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/dev/urandom\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">fread</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>seed<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>seed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">fclose</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    seed <span class=\"token operator\">=</span> seed <span class=\"token operator\">%</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>seed <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n        seed <span class=\"token operator\">=</span> seed <span class=\"token operator\">*</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">srand</span><span class=\"token punctuation\">(</span>seed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> seed<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">long</span> <span class=\"token function\">get_bet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"How much will you wager?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Current Balance: $%lu \\t Current Wins: %lu\\n\"</span><span class=\"token punctuation\">,</span> cash<span class=\"token punctuation\">,</span> wins<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">long</span> bet <span class=\"token operator\">=</span> <span class=\"token function\">get_long</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>bet <span class=\"token operator\">&lt;=</span> cash<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> bet<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"You can't bet more than you have!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">long</span> <span class=\"token function\">get_choice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Choose a number (1-%d)\\n\"</span><span class=\"token punctuation\">,</span> ROULETTE_SIZE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">long</span> choice <span class=\"token operator\">=</span> <span class=\"token function\">get_long</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> <span class=\"token operator\">&lt;=</span> choice <span class=\"token operator\">&amp;&amp;</span> choice <span class=\"token operator\">&lt;=</span> ROULETTE_SIZE<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> choice<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Please enter a valid choice.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">print_flag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">char</span> flag<span class=\"token punctuation\">[</span><span class=\"token number\">48</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    FILE <span class=\"token operator\">*</span>file<span class=\"token punctuation\">;</span>\n    file <span class=\"token operator\">=</span> <span class=\"token function\">fopen</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"flag.txt\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>file <span class=\"token operator\">==</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Failed to open the flag file\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">fgets</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%s\"</span><span class=\"token punctuation\">,</span> flag<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>win_msgs<span class=\"token punctuation\">[</span>NUM_WIN_MSGS<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"Wow.. Nice One!\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"You chose correct!\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Winner!\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Wow, you won!\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Alright, now you're cooking!\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Darn.. Here you go\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Darn, you got it right.\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"You.. win.. this round...\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"Congrats!\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"You're not cheating are you?\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>lose_msgs1<span class=\"token punctuation\">[</span>NUM_LOSE_MSGS<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">\"WRONG\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Nice try..\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"YOU LOSE\"</span><span class=\"token punctuation\">,</span>\n                                         <span class=\"token string\">\"Not this time..\"</span><span class=\"token punctuation\">,</span>\n                                         <span class=\"token string\">\"Better luck next time...\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>lose_msgs2<span class=\"token punctuation\">[</span>NUM_LOSE_MSGS<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"Just give up!\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"It's over for you.\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Stop wasting your time.\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"You're never gonna win\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"If you keep it up, maybe you'll get the flag in 100000000000 years\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">spin_roulette</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> spin<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> n<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Roulette  :  \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> i<span class=\"token punctuation\">,</span> j<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> s <span class=\"token operator\">=</span> <span class=\"token number\">12500</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> ROULETTE_SPINS<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        n <span class=\"token operator\">=</span> <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">%</span> ROULETTE_SIZE<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">usleep</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\b \\b\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> ROULETTE_SPINS<span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> <span class=\"token punctuation\">(</span>ROULETTE_SPINS <span class=\"token operator\">+</span> ROULETTE_SIZE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        n <span class=\"token operator\">=</span> <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">%</span> ROULETTE_SIZE<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">%</span> ROULETTE_SIZE<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> spin<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\b \\b\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token function\">usleep</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\b \\b\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> k <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> k <span class=\"token operator\">&lt;</span> ROULETTE_SIZE<span class=\"token punctuation\">;</span> k<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        n <span class=\"token operator\">=</span> <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>i <span class=\"token operator\">+</span> k<span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> ROULETTE_SIZE<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        s <span class=\"token operator\">=</span> <span class=\"token number\">1.1</span> <span class=\"token operator\">*</span> s<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">usleep</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>j <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> n<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\b \\b\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"%ld\"</span><span class=\"token punctuation\">,</span> spin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">usleep</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">play_roulette</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> choice<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> bet<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Spinning the Roulette for a chance to win $%lu!\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> bet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">long</span> spin <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> ROULETTE_SIZE<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">spin_roulette</span><span class=\"token punctuation\">(</span>spin<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>spin <span class=\"token operator\">==</span> choice<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        cash <span class=\"token operator\">+=</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> bet<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span>win_msgs<span class=\"token punctuation\">[</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> NUM_WIN_MSGS<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        wins <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span>lose_msgs1<span class=\"token punctuation\">[</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> NUM_LOSE_MSGS<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span>lose_msgs2<span class=\"token punctuation\">[</span><span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span> NUM_LOSE_MSGS<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> argc<span class=\"token punctuation\">,</span> <span class=\"token keyword\">char</span> <span class=\"token operator\">*</span>argv<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setvbuf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stdout</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span> _IONBF<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    cash <span class=\"token operator\">=</span> <span class=\"token function\">get_rand</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Welcome to ONLINE ROULETTE!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Here, have $%ld to start on the house! You'll lose it all anyways \"</span>\n           <span class=\"token string\">\">:)\\n\"</span><span class=\"token punctuation\">,</span>\n           cash<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">long</span> bet<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">long</span> choice<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>cash <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        bet <span class=\"token operator\">=</span> <span class=\"token function\">get_bet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        cash <span class=\"token operator\">-=</span> bet<span class=\"token punctuation\">;</span>\n        choice <span class=\"token operator\">=</span> <span class=\"token function\">get_choice</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token function\">play_roulette</span><span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">,</span> bet<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>wins <span class=\"token operator\">>=</span> MAX_WINS<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Wow you won %lu times? Looks like its time for you cash \"</span>\n                   <span class=\"token string\">\"you out.\\n\"</span><span class=\"token punctuation\">,</span>\n                   wins<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Congrats you made $%lu. See you next time!\\n\"</span><span class=\"token punctuation\">,</span> cash<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>cash <span class=\"token operator\">></span> ONE_BILLION<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">printf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"*** Current Balance: $%lu ***\\n\"</span><span class=\"token punctuation\">,</span> cash<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>wins <span class=\"token operator\">>=</span> HOTSTREAK<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span>\n                    <span class=\"token string\">\"Wow, I can't believe you did it.. You deserve this flag!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">print_flag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Wait a second... You're not even on a hotstreak! Get out \"</span>\n                     <span class=\"token string\">\"of here cheater!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">puts</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Haha, lost all the money I gave you already? See ya later!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Here are some analysis that I can derive from that code.</p>\n<ul>\n<li>The program get a seed from <code class=\"language-text\">/dev/urandom</code> then seed the random module. Also this seed is returned and used as the initial cash balance. This value range between 1 and 5000. Because you have the seed, you can run a C program that take the seed and return the random sequence that the server use.</li>\n<li>The <code class=\"language-text\">get_long</code> function looks like it's susceptible to overflow. While getting input, the value is stored into a uint64 variable, but the result is converted into signed int32. So if you input anything bigger than the signed int max (<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msup><mn>2</mn><mn>3</mn></msup><mn>1</mn><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^31 - 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.897438em;vertical-align:-0.08333em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>), the result will be it's two's complement (<span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>−</mo><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mn>3</mn></msup><mn>2</mn><mo>−</mo><mi>i</mi><mi>n</mi><mi>p</mi><mi>u</mi><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">-(2^32 - input)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.064108em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\">n</span><span class=\"mord mathdefault\">p</span><span class=\"mord mathdefault\">u</span><span class=\"mord mathdefault\">t</span><span class=\"mclose\">)</span></span></span></span>). If you input 3294967296, the program will see that you have betted negative one billion dollars, so if you lose the round you will actually gain money.</li>\n<li>\n<p>The program will exit in the following case:</p>\n<ul>\n<li>You have won 16 rounds in total: no flag</li>\n<li>You have more than 1 billion dollars in your balance, but won less than three round: no flag</li>\n<li>You have more than 1 billion dollars in your balance, and won more than three round:\nthis case will give you the flag</li>\n</ul>\n</li>\n<li>\n<p>Because the game exit after 16 rounds and doesn't give you the flag in this case, you can't possibly won one billion dollars by winning all 16 rounds. You can prove this quite easily:</p>\n<ul>\n<li>The maximum amount of cash you can get initially is 5000.</li>\n<li>If you bet all your balance and win the round, your balance get doubled.</li>\n<li>After 16 winning rounds, your balance can best reach <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mn>5000</mn><mo>∗</mo><msup><mn>2</mn><mn>1</mn></msup><mn>6</mn></mrow><annotation encoding=\"application/x-tex\">5000 * 2^16</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">5</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span><span class=\"mord\">6</span></span></span></span> which is way below one billion dollars.</li>\n</ul>\n</li>\n</ul>\n<p>Therefore, you can devise the following strategy:</p>\n<ul>\n<li>Start the game, get the random seed that the server use (the initial balance). Plug that number in a C program, and get the random sequence that the server uses for rouletting. Remember to use GCC to compile that program on a Linux system, not on Mac OS because the pseudo-random generation process is different on these two OSes.</li>\n<li>Win the first three round with some small bet. Bear in mind that after a win round, the server takes another random number, so the roulette result is every second number. For example, if you have the following sequence: <code class=\"language-text\">23 35 24 24 10 4 7 3 21 ...</code>, you should bet on <code class=\"language-text\">23, 24, 10</code> to win three round.</li>\n<li>After that, bet a negative billion dollars, and deliberately lose that round.</li>\n<li>Grab the flag.</li>\n</ul>","frontmatter":{"date":"2019-05-02T18:07:00.000Z","title":"PicoCTF 2018 Writeup General Skills.","keyword":["ctf","hacking"],"description":"Basic stuff I guess."},"fields":{"slug":"/picoctf2018-writeup/general/"},"tableOfContents":"<ul>\n<li><a href=\"/picoctf2018-writeup/general/#general-warmup-1-2-3\">General Warmup 1-2-3</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#resources\">Resources</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#grep-1\">Grep 1</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#net-cat\">Net Cat</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#strings\">Strings</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#pipe\">Pipe</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#grep-2\">Grep 2.</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#aca-shell-a\">ACA-Shell-A</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#environ\">Environ</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#ssh-keyz\">SSH-Keyz.</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#what-base-is-this\">What base is this?</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#you-cant-see-me\">You can't see me</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#absolutely-relative\">Absolutely relative.</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#in-out-error\">In-Out-Error</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#store\">Store</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#script-me\">Script me</a></li>\n<li><a href=\"/picoctf2018-writeup/general/#roulette\">Roulette</a></li>\n</ul>"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"older":{"frontmatter":{"title":"My node_modules is too big.","date":"2019-04-28T20:23:00.000Z","description":"Some approaches to save a bit of precious disk space.","keyword":["nodejs","programming"]},"fields":{"slug":"/node_modules-to-big/","readingTime":{"text":"4 min read"}}},"newer":{"frontmatter":{"title":"PicoCTF 2018 Writeup Cryptography.","date":"2019-05-04T21:40:00.000Z","description":"Math and stuff.","keyword":["ctf","hacking"]},"fields":{"slug":"/picoctf2018-writeup/crypto/","readingTime":{"text":"10 min read"}}},"series":"picoctf2018-writeup"}}}